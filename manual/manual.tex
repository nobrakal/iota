\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage{minted}

\usepackage{syntax}

\author{Alexandre Moine}
\title{Iota - Manual}

\begin{document}
\maketitle

\section{Introduction}
Iota is a programming language.

\section{Syntax of the language}
Nota Bene:
\begin{itemize}
\item \verb|[<rule>]| symbolise a list of \verb|<rule>|.
\item \verb|[<rule> // <sep>]| symbolise a list of \verb|<rule>| separated by \verb|<sep>|.
\end{itemize}

Comments Ã -la-OCaml can be used everywhere.

\subsection{Syntax of programs}

\begin{grammar}
  <lident> ::= [a-z][a-zA-Z0-9]*

  <hident> ::= [A-Z][a-zA-Z0-9]*

  <type> ::= <lident>

  <term> ::= <lident>
  \alt `parent<' <type> `,' <type> `>(' <term> `)'
  \alt <term> `.' <lident>

  <guard> ::= `Eq(' <term> `,' <term> `)'
  \alt `Link(' <term> `,' <term> `)'
  \alt `TLink<' <type> `,' <type> `>(' <term> `,' <term> `)'

  <predicate> ::= <guard>
  \alt `Has(' <term> `)'
  \alt <hident> `(' <term> `)'

  <formula> ::= <predicate>
  \alt `+'<predicate>
  \alt `not' <formula>
  \alt <formula> `&&' <formula>
  \alt <formula> `||' <formula>
  \alt `(' <formula> `)'

  <safe> ::= <formula>
  \alt <lident>
  \alt <safe> `&&' <safe>
  \alt <safe> `||' <safe>
  \alt `forall' <lident> <guard> `->' <safe>
  \alt `exists' <lident> <guard> `&&' <safe>
  \alt <safe> <safe>
  \alt `(' <safe> `)'

  <letdef> ::= \lit{let} <lident> [<lident>] \lit{=} <safe>

  <general> ::=
  <guard> \lit{->} <general>
  \alt \lit{=>} <formula>

  <program> ::=
  [<letdef>] \lit{in} [<safe> // \lit{;}] \lit{ensure} [<general> // \lit{;}] \lit{maintain} [<general> // \lit{;}]

\end{grammar}

\subsection{Syntax of configuration file}
\begin{grammar}
  <constants> ::=
  \lit{let} \lit{maxprof} \lit{=} <int>

  <typedef> ::=
  \lit{type} <lident>
  \alt \lit{type} <lident> \lit{=} [<lident> \lit{to} <type> // \lit{|} ]

  <preddef> ::=
  \lit{static} <hident> \lit{about} <lident>
  \alt \lit{dynamic} <hident> \lit{about} <lident>

  <config> ::=
  <constants> [<typedef>] [<preddef>]
\end{grammar}

\section{Semantics}
\subsection{Of the configuration file}
\subsubsection{The maxporf parameter}
All trees have \emph{bound} size, thus one must specify the maximum size of a tree.

\subsubsection{Types}
Nodes, leaves and some operations on trees are \emph{typed}.
\begin{itemize}
\item Types without accessors. They will represent leaves.
\item Types with accesors. They will represent nodes. Each accessor is composed by a name and a type.
  This indicates the type of the child and how to access it.
\end{itemize}

\subsubsection{Predicates}
Finally, one have to define predicates. A predicate gives information about a node of some type.

\subsubsection{Example}
Here is a valid configuration file:
\begin{minted}[frame=lines]{ocaml}
let maxprof = 10

type site
type mol = m to mol | f to site | g to site

static E about mol
dynamic Active about mol
dynamic Open about site
\end{minted}

\end{document}